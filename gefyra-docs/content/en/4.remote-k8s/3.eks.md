---
title: Getting started with Gefyra and Elastic Kubernetes Service (EKS)
description: This guide will show you how to use Gefyra for the remote development of a Kubernetes application running on Elastic Kubernetes Service (EKS).
navigation:
  icon: i-simple-icons-amazoneks
  title: Elastic Kubernetes Service (EKS)
---

## Prerequisites

1. You have the [aws](https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-quickstart.html){target="_blank"} command installed and configured
2. Follow the [installation](/en/quick-start/installation) of Gefyra for your preferred platform

Additionally, you need an account for the Amazon Web Services including the permission to create a new cluster. Make sure your `aws` is using the right project configuration and/or profile.

## Setup a cluster

1. The easiest way to create a new cluster is using `aws`:

```sh
aws eks create-cluster --name gefyra --kubernetes-version 1.22 --role-arn arn:aws:iam::111122223333:role/myAmazonEKSClusterRole --resources-vpc-config subnetIds=subnet-ExampleID1,subnet-ExampleID2,securityGroupIds=sg-ExampleID1
```

This may take a long time. You can check the cluster status with:

::code-preview
`"ACTIVE"`

#code
```sh
aws eks describe-cluster --name gefyra --query "cluster.status"
```
::

2. Depending on your way of creating the cluster, you may have to add a `NodeGroup` to  the cluster, so you can actually run workloads.

3. Pull the `kubectl` configuration to connect to the cluster, with:

```sh
aws eks update-kubeconfig --name gefyra
```

Now you should be able to run any `kubectl` command in that cluster.

4. Apply some workload, for example from the testing directory of this repo:  

```sh
kubectl apply -f https://raw.githubusercontent.com/gefyrahq/gefyra/main/testing/workloads/hello_dd.yaml
```

5. **Important:** before Gefyra can connect from outside the cluster, you must set the security group of the nodes to allow UDP traffic on port 31820.

Find out the security group of the cluster. Then, create the required inbound traffic rule:

::code-preview
`<security-group-id>`

#code
```sh
aws eks describe-cluster --name gefyra --query "cluster.resourcesVpcConfig.clusterSecurityGroupId"
```
::

```sh
aws ec2 authorize-security-group-ingress --group-id "<security-group-id>" --protocol udp --port 31820  --cidr 0.0.0.0/0
```

## Running Gefyra

1. At first, we need a host IP of one of our nodes. You can get
them by running 

```sh
kubectl get nodes -o wide |  awk {'print $1" " $2 " " $7'} | column -t
```

Pick one of them from the `EXTERNAL-IP` column.

2. Now you can run 

```sh
gefyra up --host <IP>
```

3. Run a local Docker image with Gefyra to make it part of the cluster.
   1. Build your Docker image with a local tag, for example from the testing directory:
   
   ```sh
   cd testing/images/ && docker build -f Dockerfile.local . -t pyserver
   ```
   
   2. Execute Gefyra's run command:    
   
   ```sh
   gefyra run -i pyserver -N mypyserver -n default
   ```
   
   3. _Exec_ into the running container and look around. You will find the container to run within your Kubernetes cluster.  
   
   ```sh
   docker exec -it mypyserver bash
   ```

   4. Print out the website of the cluster service _hello-nginx_ from within the cluster.

   ```sh
   wget -O- hello-nginx
   ```
   
4. Create a bridge to intercept the traffic to the cluster application with the one running locally:  

```sh
gefyra bridge -N mypyserver -n default --port 80:8000 --target deploy/hello-nginxdemo/hello-nginx
```    

5. List all running _bridges_:

```sh
gefyra list --bridges
```

6. _Unbridge_ the local container and reset the cluster to its original state:  

```sh
gefyra unbridge -N mypybridge
```

## Cleaning up
Remove Gefyra's components from the cluster with `gefyra down`

::card
#title
  Please provide us with your feedback

#default
  Did everything work as expected? How was the experience of using Gefyra? We'd appreciate if you could take 2 minutes of your time to fill out our [feedback form](https://forms.gle/AWT9NparpTVk8E978){target="_blank"}.
::